# gradle-versions-prettify

Provides a more concise format for reports generated by [gradle-versions-plugin](https://github.com/ben-manes/gradle-versions-plugin).

## Output Format

`gradle-versions-plugin` by default generates somewhat verbose plaintext reports. Let's have a look at the report generated from a newly created Android project with Kotlin support:

```
------------------------------------------------------------
: Project Dependency Updates (report to plain text file)
------------------------------------------------------------

The following dependencies are using the latest release version:
 - com.android.support:appcompat-v7:28.0.0
 - com.android.support.constraint:constraint-layout:1.1.3
 - com.android.support.test:runner:1.0.2
 - com.android.support.test.espresso:espresso-core:3.0.2
 - com.android.tools.build:aapt2:3.2.1-4818971
 - com.android.tools.build:gradle:3.2.1
 - com.android.tools.lint:lint-gradle:26.2.1
 - com.github.ben-manes.versions:com.github.ben-manes.versions.gradle.plugin:0.20.0
 - junit:junit:4.12

The following dependencies have later release versions:
 - org.jetbrains.kotlin:kotlin-android-extensions [1.2.71 -> 1.3.10]
     https://kotlinlang.org/
 - org.jetbrains.kotlin:kotlin-gradle-plugin [1.2.71 -> 1.3.11]
     https://kotlinlang.org/
 - org.jetbrains.kotlin:kotlin-stdlib-jdk7 [1.2.71 -> 1.3.10]
     https://kotlinlang.org/

Gradle updates:
 - Gradle: [4.6 -> 5.0 -> 5.1-rc-2]
```

> *Please note that I've excluded `alpha` and `beta` versions from this via gradle configuration, as you're usually only interested in stable releases.*

Only three out of twelve dependencies need to be updated (apart from Gradle). Nevertheless, the report begins with the nine dependencies that are already up-to-date - and they actually take more space than the ones we're interested in! This becomes even worse in bigger projects with more dependencies.

Wouldn't it be nice to only have a list of actionable items?

This is where this formatter comes into play. Let's see the report after prettification:

```
Minor Updates
=================================

org.jetbrains.kotlin:kotlin-android-extensions	1.2.71 => 1.3.10
org.jetbrains.kotlin:kotlin-gradle-plugin     	1.2.71 => 1.3.11
org.jetbrains.kotlin:kotlin-stdlib-jdk7       	1.2.71 => 1.3.10


9/12 dependencies already up-to-date. You may have forgotten to update in the last time...

Gradle Update Available
=================================

Gradle can be updated from 4.6 to 5.0
```

Granted, the summary is a bit snarky, but isn't this way cleaner? Now you know exactly what to do!

## How it works

Before we start, let me say that yes, this could've been done via a custom outputFormatter specified in your `build.gradle`. But where's the fun in that? Besides, I'm afraid of Groovy code.

Instead, this prettifier uses [Lua](https://www.lua.org/), an awesome scripting language that can be run on virtually any machine in the world. If you've already installed Lua, great! If you haven't, check out the chapter on [Setup](#setup)

In order to generate our pretty little report, we first have to generate the default report (in JSON format for easier consumption):

```
gradlew dependencyUpdate -DoutputDir=. -Drevision=release -DoutputFormatter=json
```

We're using `-Drevision=release` here because we're only interested in stable releases. The prettifier does not yet work with milestone or even integration versions :)

After that, we can process the JSON file into the above format:

```
./parse.lua report.json
```

And that's it, the script will now output a far more concise report!

## Setup

Just in case you haven't worked with Lua before, please check the official [Getting started](https://www.lua.org/start.html) page on how to install it on your OS. On most Unixes, it should only be a matter of seconds.

After that, check out this repository and please don't forget to `git submodule update`.